## 20220608 TIL

ì˜¤ëŠ˜ì€ ê³¼ì œ readme ì ê³  ì •ì‹ ì´ ì—†ì—ˆë‹¤...

ê°œì¸ì ìœ¼ë¡œ ì¼ì´ ì¢€ ë” ìƒê²¨ì„œ ì •ë¦¬í•˜ê¸° í˜ë“¤ì—ˆë˜ ê²ƒ ê°™ë‹¤

## @RequestParam, @PathVariable

### @RequestParam

ê²€ìƒ‰ ë˜ëŠ” í˜ì´ì§•ì—ì„œ ë§ì´ ì“°ëŠ” ê²ƒ ê°™ë‹¤

```
localhost:8080/api?param1=10&param2=20
```

ì´ëŸ° ê²½ìš°ì— @RequestParamì„ ë°›ì•„ì™€ì„œ ì²˜ë¦¬í•œë‹¤

null ê°’ì˜ ì²˜ë¦¬ê°€ PathVariableë³´ë‹¤ëŠ” ìœ ì—°í•˜ë‹¤.

```java
@GetMapping("/api")
    public String hello(@RequestParam int param1, @RequestParam int param2) {
```





### @PathVariable

REST APIì—ì„œ ë§ì´ ì‚¬ìš©í•œë‹¤.

```java
@GetMapping("/{postId}/comments")
public List<Comment> getComments(@PathVariable Long postId) {
    Post myPost = postService.findById(postId);
    return myPost.getCommentList();
}
```

RequestMappingì˜ value ë‚´ì—ì„œ {} ì‚¬ì´ì— ë³€ìˆ˜ëª…ì„ ë„£ëŠ”ë‹¤.

ê·¸ë¦¬ê³  í•´ë‹¹ ë³€ìˆ˜ëª…ì„ ê°–ëŠ” ë³€ìˆ˜ë¡œ PathVariableì„ ë¶ˆëŸ¬ì˜¨ë‹¤.



## ì˜ˆì™¸ ì²˜ë¦¬

#### í¬ìŠ¤íŠ¸, ëŒ“ê¸€ì˜ ì‘ë™ì—ëŠ” ì–´ë–¤ ì˜ˆì™¸ ì²˜ë¦¬ê°€ í•„ìš”í• ê¹Œ?

ë‚´ê°€ ìƒê°í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ì—ì„œëŠ” 1ï¸âƒ£**ë¹ˆ ê°’**, 2ï¸âƒ£**ìœ íš¨í•˜ì§€ ì•Šì€ ê°’**ì´ ë“¤ì–´ì˜¤ëŠ” ê²½ìš°ì¼ ê²ƒ ê°™ë‹¤.



#### 1ï¸âƒ£ ê³µë°±ì´ ë“¤ì–´ì˜¬ ìˆ˜ ìˆëŠ” ê²½ìš°

1. GET, POST, PUT, DELETEì‹œì˜ **@PathVariable**

   - postIdê°€ null & commentIdê°€ null

     - ```@PathVariable(required = false) String board_id``` PathVariableì˜ defaultëŠ” required=trueì´ë‹¤. í˜¹ì‹œë¼ë„ nullê°’ì„ ë°›ê³  ë”°ë¡œ ì²˜ë¦¬í•˜ê³ ì í•˜ëŠ” ê²½ìš°ëŠ” required=falseë¥¼ í™œìš©í•˜ë©´ ëœë‹¤.

     - ```http://localhost:8080/posts//```ë¥¼ ìš”ì²­í–ˆì„ ì‹œ 404 Not Found errorê°€ ë°œìƒí•˜ê²Œ ëœë‹¤. ì´ëŸ° ê²½ìš°ì— ì˜ˆì™¸ ì²˜ë¦¬ê°€ í•„ìš”í• ê¹Œ? ğŸ‘‰ PathVariableì˜ íŠ¹ì„±ìƒ nullì„ ë°˜í™˜í•˜ëŠ”ê±´ ì¢‹ì§€ ì•Šë‹¤ê³  í•œë‹¤. í•„ìš”í•œ ê²½ìš° @RequestParamì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì ì ˆí•˜ë‹¤ê³  í•œë‹¤.ğŸ™ƒ

2. POST, PUTì‹œì˜ **@RequestBody** 

   - Post (ê²Œì‹œë¬¼)
     1.  Title(ì œëª©)ì´ ë¹„ì–´ìˆëŠ” ê²½ìš°
     2.  Author(ì‘ì„±ì)ê°€ ë¹„ì–´ ìˆëŠ” ê²½ìš°
     3.  Content(ë‚´ìš©)ì´ ë¹„ì–´ ìˆëŠ” ê²½ìš°
   - Comment (ëŒ“ê¸€)
     1.  Content(ë‚´ìš©)ì´ ë¹„ì–´ìˆëŠ” ê²½ìš°
     2.  Author(ì‘ì„±ì)ê°€ ë¹„ì–´ ìˆëŠ” ê²½ìš°

```java
@Component
public class Validator {
    // comment - ëŒ“ê¸€ì˜ ì˜ˆì™¸ì²˜ë¦¬
    public static void validateComment(CommentRequestDto commentRequestDto) {
        if (commentRequestDto.getAuthor().equals("")) {
            throw new MyException(ErrorCode.EMPTY_COMMENT_AUTHOR);
        }
        if (commentRequestDto.getContent().equals("")) {
            throw new MyException(ErrorCode.EMPTY_COMMENT_CONTENT);
        }
    }
	// post - ê²Œì‹œë¬¼ ì˜ ì˜ˆì™¸ì²˜ë¦¬
    public static void validatePost(PostRequestDto postRequestDto) {
        if (postRequestDto.getAuthor().equals("")) {
            throw new MyException(ErrorCode.EMPTY_POST_AUTHOR);
        }
        if (postRequestDto.getTitle().equals("")) {
            throw new MyException(ErrorCode.EMPTY_POST_TITLE);
        }
        if (postRequestDto.getContent().equals("")) {
            throw new MyException(ErrorCode.EMPTY_POST_CONTENT);
        }
    }
}
```




#### 2ï¸âƒ£ ìœ íš¨í•˜ì§€ ì•Šì€ ê°’ì´ ë“¤ì–´ì˜¤ëŠ” ê²½ìš°

1. ìš°ë¦¬ê°€ ì›í•˜ëŠ” í˜•ì‹ì˜ ê°’ì´ ë“¤ì–´ì˜¤ì§€ ì•Šê±°ë‚˜ (Longì„ ë°›ê³  ì‹¶ì€ë° Stringì´ ë“¤ì–´ì™”ì„ ë•Œ / ì–‘ìˆ˜ì—¬ì•¼ í•˜ëŠ” idê°’ì— ìŒìˆ˜ê°€ ë“¤ì–´ì™”ì„ ë•Œ),

2. DB ì¡°íšŒ ì‹œ ì»¤ë²„í•˜ëŠ” ë²”ìœ„ ì™¸ì˜ ê°’ì´ ë“¤ì–´ì™”ì„ ë•Œì´ë‹¤ (ex : ì¡´ì¬í•˜ì§€ ì•ŠëŠ” postId)

1ì˜ ê²½ìš° ë‹¨ìˆœíˆ DTOì—ì„œ Validatorë¥¼ ì¨ì£¼ë©´ ë˜ëŠ”ë°, 2ì˜ ê²½ìš°ëŠ” repositoryë¥¼ ë”°ë¡œ ë¶ˆëŸ¬ì™€ì„œ ì¡°íšŒí•´ë³´ëŠ” ì¼ê¹Œì§€ ê±°ì³ì•¼ í•œë‹¤..

ì¼ë‹¨ ê°„ë‹¨í•˜ê²Œ ìˆ«ìê°€ ì•„ë‹Œ ê°’ì„ ë§‰ëŠ” ë°©ë²•ì€ ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.

GET /spring/comment ê°™ì´ ë¬¸ìì—´ì´ ë“¤ì–´ê°€ëŠ” ê²½ìš° 404ë¥¼ í˜¸ì¶œí•˜ì§€ ëª»í•˜ê³  ë¹ˆ í˜ì´ì§€ë¥¼ ë³´ì—¬ì£¼ì—ˆê¸° ë•Œë¬¸ì´ë‹¤

```java
@GetMapping("/{postId:[0-9]*}/comments")
//{id:[A-Z]*} ì‹ìœ¼ë¡œë„ ì‚¬ìš©ê°€ëŠ¥
public List<Comment> getComments(@PathVariable Long postId) {
    Post myPost = postService.findById(postId);
    return myPost.getCommentList();
}
```

ì´ë ‡ê²Œ ìˆ˜ì •í•œ ë’¤ì—ëŠ” ì¼ë‹¨ 404 ë¥¼ ì˜ ë±‰ì–´ì£¼ê¸´ í•˜ëŠ”ë°... ì»¤ìŠ¤í„°ë§ˆì´ì§•ì„ ë” í•´ ë´ì•¼ê² ë‹¤.